# differential_equations（物理で使う微分方程式の入口）

微分方程式は、物理で「法則」から「予測」へ進むための中核です。  
運動方程式、回路方程式、拡散方程式、波動方程式――ほぼすべてが微分方程式として書かれます。

この章では、EMAN-Physics 風に

- 直観（何を予測する式か）
- 導出（途中式を省略しない）
- 確認（初期条件・次元・極限）

の順で、最小限かつ実践的に整理します。

---

## 1. 学習目標

1. 微分方程式が「時間発展のルール」であることを説明できる。
2. 1階線形 ODE、2階線形 ODE の基本解法を選択できる。
3. 一般解と特殊解、初期条件と境界条件の違いを使い分けできる。
4. 解いた式を初期条件・次元・極限で検算できる。
5. 後続の [ode_methods.md](ode_methods.md) で扱う個別手法に接続できる。

## 2. 前提知識（必要最小セット）

- 微分積分の基礎（連鎖律、積分）
- 指数関数・三角関数の微分
- 複素数の初歩（2階 ODE で特性方程式の根に使用）

復習リンク:

- [../calculus_techniques/README.md](../calculus_techniques/README.md)
- [../00_overview.md](../00_overview.md)

## 3. 記法・単位・符号規約

- 独立変数: 主に時間 $t$
- 未知関数: $x(t), y(t), q(t)$
- 1階導関数: $\dot x=dx/dt$
- 2階導関数: $\ddot x=d^2x/dt^2$
- 初期条件: $x(0)=x_0$, $\dot x(0)=v_0$
- 物理定数は SI 単位で扱い、各項の次元一致を必ず確認

## 4. 本文（直観→導出→確認）

### 4.1 直観：微分方程式は「未来を更新するルール」

例えば

$$
\frac{dx}{dt}=v
$$

は「位置の変化率が速度」という更新則です。  
力学ではさらに

$$
m\ddot x=F(x,\dot x,t)
$$

となり、$x$ の時間発展を決めます。

### 4.2 導出A：1階線形 ODE（指数減衰）

代表例として

$$
\frac{dN}{dt}=-\lambda N,\qquad N(0)=N_0
$$

を解く。

変数分離:

$$
\frac{dN}{N}=-\lambda dt
$$

両辺積分:

$$
\int\frac{dN}{N}=\int -\lambda dt
\Rightarrow
\ln|N|=-\lambda t + C
$$

指数化:

$$
N=C'e^{-\lambda t}
$$

初期条件 $N(0)=N_0$ より $C'=N_0$。

$$
N(t)=N_0e^{-\lambda t}
$$

#### 確認

- $t=0$ で $N_0$
- $\lambda>0$ で単調減少
- 指数の中身 $\lambda t$ は無次元（$[\lambda]=\mathrm{s^{-1}}$）

### 4.3 導出B：2階線形 ODE（単振動）

$$
\ddot x+\omega^2x=0
$$

を解く。

試行解 $x=e^{rt}$ を代入:

$$
r^2e^{rt}+\omega^2e^{rt}=0
Rightarrow r^2+\omega^2=0
$$

特性方程式の根:

$$
r=\pm i\omega
$$

よって実関数解は

$$
x(t)=A\cos(\omega t)+B\sin(\omega t)
$$

初期条件 $x(0)=x_0,\ \dot x(0)=v_0$ より

$$
A=x_0,
\qquad
\dot x(t)=-A\omega\sin(\omega t)+B\omega\cos(\omega t)
$$

$$
\dot x(0)=B\omega=v_0
\Rightarrow B=\frac{v_0}{\omega}
$$

最終的に

$$
x(t)=x_0\cos(\omega t)+\frac{v_0}{\omega}\sin(\omega t)
$$

### 4.4 確認：極限とエネルギー

速度は

$$
\dot x(t)=-x_0\omega\sin(\omega t)+v_0\cos(\omega t)
$$

力学エネルギー

$$
E=\frac12m\dot x^2+\frac12m\omega^2x^2
$$

に代入すると定数（保存）になる。  
また $t\to0$ 展開で

$$
x(t)\approx x_0+v_0t
$$

が出て、初期速度の意味と一致。

## 5. 例題（3題）

### 例題1（易）: 変数分離

$$
\frac{dy}{dt}=3y,\quad y(0)=2
$$

**解答**

$$
y=Ce^{3t},\ y(0)=2\Rightarrow C=2
$$

$$
y(t)=2e^{3t}
$$

### 例題2（中）: 1階非同次

$$
\frac{dy}{dt}+2y=4
$$

**解答（定数特殊解 + 同次解）**

同次解 $y_h=Ce^{-2t}$。定数特殊解を $y_p=A$ と置くと

$$
0+2A=4\Rightarrow A=2
$$

よって

$$
y(t)=Ce^{-2t}+2
$$

### 例題3（やや難）: 減衰振動の判別

$$
\ddot x+2\gamma\dot x+\omega_0^2x=0
$$

で、振動する条件を求めよ。

**解答**

特性方程式

$$
r^2+2\gamma r+\omega_0^2=0
$$

判別式

$$
\Delta=4(\gamma^2-\omega_0^2)
$$

振動には複素根が必要なので $\Delta<0$:

$$
\gamma<\omega_0
$$

## 6. よくある誤解・落とし穴

1. 一般解を出して満足し、初期条件を入れ忘れる。
2. $e^{rt}$ を代入した後、$e^{rt}\neq0$ で割る操作を飛ばして混乱する。
3. 指数の次元（無次元条件）を確認しない。
4. 2階方程式で独立な定数を1つしか置かない。

## 7. 章末まとめ

- 微分方程式は物理法則を予測可能な形にする言語である。
- 1階線形は分離・積分因子・特殊解で処理できる。
- 2階線形は特性方程式で根の性質を見るのが基本。
- 一般解 + 初期条件で物理的解が決まる。
- 検算は初期値・極限・次元で行う。
- 後続章では具体的な解法パターンを増やす。

## 8. 演習（10問）＋解答

難易度配分: 易4・中4・難2

### 問題

1. **易**: $dy/dt=5y,\ y(0)=1$ を解け。  
2. **易**: $dy/dt=-2y$ の一般解を求めよ。  
3. **易**: $\ddot x+9x=0$ の一般解を求めよ。  
4. **易**: $x(0)=2,\ \dot x(0)=0$ を満たす $\ddot x+4x=0$ の解を求めよ。  
5. **中**: $dy/dt+y=3$ の一般解を求めよ。  
6. **中**: $\ddot x+4\dot x+3x=0$ の一般解を求めよ。  
7. **中**: $\ddot x+2\dot x+2x=0$ の一般解を求めよ。  
8. **中**: $N'= -\lambda N,\ N(0)=N_0$ の半減期を求めよ。  
9. **難**: $\ddot x+\omega^2x=0$ の解がエネルギー保存を満たすことを示せ。  
10. **難**: $\ddot x+2\gamma\dot x+\omega_0^2x=0$ が臨界減衰となる条件を導け。  

### 解答

1. **解答**:  
   $$y=e^{5t}$$

2. **解答**:  
   $$y=Ce^{-2t}$$

3. **解答**:  
   $$x=A\cos3t+B\sin3t$$

4. **解答**:  
   一般解 $x=A\cos2t+B\sin2t$。  
   $x(0)=2\Rightarrow A=2$, $\dot x(0)=2B=0\Rightarrow B=0$。  
   $$x=2\cos2t$$

5. **解答**:  
   同次解 $Ce^{-t}$、特殊解 $3$。  
   $$y=Ce^{-t}+3$$

6. **解答**:  
   特性方程式 $r^2+4r+3=0=(r+1)(r+3)$。  
   $$x=C_1e^{-t}+C_2e^{-3t}$$

7. **解答**:  
   特性根 $r=-1\pm i$。  
   $$x=e^{-t}(C_1\cos t + C_2\sin t)$$

8. **解答**:  
   半減期 $T_{1/2}$ は $N(T_{1/2})=N_0/2$ から
   $$e^{-\lambda T_{1/2}}=\frac12\Rightarrow T_{1/2}=\frac{\ln2}{\lambda}$$

9. **解答**:  
   $$E=\frac12m\dot x^2+\frac12m\omega^2x^2$$
   を時間微分すると
   $$\frac{dE}{dt}=m\dot x\ddot x+m\omega^2x\dot x=m\dot x(\ddot x+\omega^2x)=0$$
   よって保存。

10. **解答**:  
    特性方程式の判別式
    $$\Delta=(2\gamma)^2-4\omega_0^2=4(\gamma^2-\omega_0^2)$$
    臨界減衰は重解条件 $\Delta=0$ より
    $$\gamma=\omega_0$$

---

## ナビゲーション

- 親: [../00_overview.md](../00_overview.md)
- 子:
  - [ode_methods.md](ode_methods.md)
