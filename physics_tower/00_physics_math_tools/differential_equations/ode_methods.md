# ode_methods（常微分方程式の解法手順集）

このページは、物理で頻出する常微分方程式（ODE）を「見た瞬間に解法を選べる」ようにするための実践ガイドです。  
狙いは公式暗記ではなく、**方程式の形から戦略を選ぶ判断力** を作ることです。

---

## 1. 学習目標

1. ODE の型（分離形・1階線形・2階線形定数係数）を判別できる。
2. 型に応じて最短の解法（分離、積分因子、特性方程式）を選べる。
3. 一般解に初期条件を入れて物理解を確定できる。
4. 解の検算（代入・次元・極限）を必ず実行できる。
5. 力学・回路・熱緩和などに解法を転用できる。

## 2. 前提知識

- [README.md](README.md) にある微分方程式の基本概念
- 微分積分の基本操作
- 指数関数・三角関数・複素数（特性方程式）

## 3. 記法・単位・符号規約

- 独立変数: $t$（時間）
- 未知関数: $y(t), x(t), q(t)$
- $\dot y=dy/dt$, $\ddot y=d^2y/dt^2$
- 初期条件: $y(0)=y_0$, $\dot y(0)=v_0$
- 単位系: SI 基準（指数の肩は必ず無次元）

## 4. 本文（直観→導出→確認）

### 4.1 直観：まず「型」を読む

微分方程式は最初に型判別すると速い。

- **分離形**: $\dfrac{dy}{dt}=f(t)g(y)$
- **1階線形**: $\dfrac{dy}{dt}+P(t)y=Q(t)$
- **2階線形定数係数**: $a\ddot x+b\dot x+cx=F(t)$

この分類が、解法選択の分岐表になります。

### 4.2 導出A：分離形

$$
\frac{dy}{dt}=ky
$$

を解く。

$$
\frac{dy}{y}=kdt
$$

積分して

$$
\ln|y|=kt+C
Rightarrow y=Ce^{kt}
$$

初期条件 $y(0)=y_0$ で $C=y_0$:

$$
y(t)=y_0e^{kt}
$$

#### 確認

- $k>0$ なら増加、$k<0$ なら減衰。
- $kt$ は無次元（$[k]=\mathrm{s^{-1}}$）。

### 4.3 導出B：1階線形（積分因子法）

$$
\frac{dy}{dt}+P(t)y=Q(t)
$$

積分因子

$$
\mu(t)=e^{\int P(t)dt}
$$

を掛けると

$$
\mu\frac{dy}{dt}+\mu Py=\mu Q
$$

左辺は積の微分:

$$
\frac{d}{dt}(\mu y)=\mu Q
$$

ゆえに

$$
\mu y=\int \mu Q\,dt + C
$$

$$
y=\frac{1}{\mu}\left(\int \mu Q\,dt + C\right)
$$

**具体例**

$$
\frac{dy}{dt}+2y=4
$$

では $\mu=e^{2t}$。

$$
\frac{d}{dt}(e^{2t}y)=4e^{2t}
$$

$$
e^{2t}y=2e^{2t}+C
Rightarrow y=2+Ce^{-2t}
$$

### 4.4 導出C：2階線形定数係数

同次方程式

$$
\ddot x+2\gamma\dot x+\omega_0^2x=0
$$

試行解 $x=e^{rt}$:

$$
r^2+2\gamma r+\omega_0^2=0
$$

$$
r=-\gamma\pm\sqrt{\gamma^2-\omega_0^2}
$$

判別式で場合分け。

1. $\gamma^2>\omega_0^2$（過減衰）: 実根2つ
2. $\gamma^2=\omega_0^2$（臨界減衰）: 重根
3. $\gamma^2<\omega_0^2$（不足減衰）: 複素根

不足減衰では

$$
x(t)=e^{-\gamma t}\left(C_1\cos\omega_dt+C_2\sin\omega_dt\right),
\quad \omega_d=\sqrt{\omega_0^2-\gamma^2}
$$

### 4.5 確認テンプレ

1. 方程式へ再代入して0になるか。
2. 初期条件を入れて定数が一意に決まるか。
3. 指数や三角関数の引数が無次元か。
4. パラメータ極限（例: $\gamma\to0$）で既知解に戻るか。

## 5. 例題（3題）

### 例題1（易）

$$
\frac{dy}{dt}=-3y,\quad y(0)=5
$$

**解答**

$$
y=5e^{-3t}
$$

### 例題2（中）

$$
\frac{dy}{dt}+y=t
$$

**解答**

積分因子 $\mu=e^t$:

$$
\frac{d}{dt}(e^ty)=te^t
$$

$$
e^ty=\int te^t dt + C=e^t(t-1)+C
$$

$$
y=t-1+Ce^{-t}
$$

### 例題3（やや難）

$$
\ddot x+4\dot x+5x=0
$$

**解答**

特性方程式

$$
r^2+4r+5=0
Rightarrow r=-2\pm i
$$

したがって

$$
x=e^{-2t}(C_1\cos t + C_2\sin t)
$$

## 6. よくある誤解・落とし穴

1. 分離形で $y=0$ 解を見落とす（必要なら別扱い）。
2. 積分因子の符号ミス（$\mu=e^{\int Pdt}$）。
3. 2階方程式で定数2個を置き忘れる。
4. 一般解だけで止まり、初期条件で確定しない。

## 7. 章末まとめ

- まず型判別、次に解法選択が ODE の基本動作。
- 分離形は変数を左右に分けて積分。
- 1階線形は積分因子で積の微分にする。
- 2階定数係数は特性方程式の根で解の形が決まる。
- 初期条件・次元・極限の3点検算で信頼性が上がる。
- 物理応用では解の形（増加/減衰/振動）自体が重要な情報。

## 8. 演習（10問）＋解答

難易度: 易4・中4・難2

### 問題

1. **易**: $y'=2y,\ y(0)=3$ を解け。  
2. **易**: $y'=-y$ の一般解を求めよ。  
3. **易**: $x''+x=0$ の一般解を求めよ。  
4. **易**: $x''+4x=0,\ x(0)=1,\ x'(0)=0$ を解け。  
5. **中**: $y'+3y=6$ の一般解を求めよ。  
6. **中**: $y'+2y=e^{-t}$ を積分因子で解け。  
7. **中**: $x''+2x'+x=0$ の一般解を求めよ。  
8. **中**: $x''+6x'+10x=0$ の一般解を求めよ。  
9. **難**: $x''+2\gamma x'+\omega_0^2x=0$ が不足減衰となる条件を示せ。  
10. **難**: $y'+ay=b$（定数 $a,b$）の定常解と過渡解を分離して書け。  

### 解答

1. **解答**:  
   $$y=3e^{2t}$$

2. **解答**:  
   $$y=Ce^{-t}$$

3. **解答**:  
   $$x=C_1\cos t+C_2\sin t$$

4. **解答**:  
   一般解 $x=C_1\cos2t+C_2\sin2t$。  
   $x(0)=1\Rightarrow C_1=1$, $x'(0)=2C_2=0\Rightarrow C_2=0$。  
   $$x=\cos2t$$

5. **解答**:  
   $$y=2+Ce^{-3t}$$

6. **解答**:  
   $\mu=e^{2t}$。
   $$\frac{d}{dt}(e^{2t}y)=e^t$$
   $$e^{2t}y=e^t+C\Rightarrow y=e^{-t}+Ce^{-2t}$$

7. **解答**:  
   特性方程式 $(r+1)^2=0$。  
   $$x=(C_1+C_2t)e^{-t}$$

8. **解答**:  
   根 $r=-3\pm i$。  
   $$x=e^{-3t}(C_1\cos t+C_2\sin t)$$

9. **解答**:  
   判別式条件
   $$\gamma^2-\omega_0^2<0\Rightarrow \gamma<\omega_0$$

10. **解答**:  
    定常解 $y_s=b/a$（$a\neq0$）、過渡解 $y_t=Ce^{-at}$。  
    $$y(t)=\frac{b}{a}+Ce^{-at}$$

---

## ナビゲーション

- 親: [README.md](README.md)
